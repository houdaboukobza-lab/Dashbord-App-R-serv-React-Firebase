{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _reactAddonsShallowCompare = require('react-addons-shallow-compare');\n\nvar _reactAddonsShallowCompare2 = _interopRequireDefault(_reactAddonsShallowCompare);\n\nvar _reactAddonsUpdate = require('react-addons-update');\n\nvar _reactAddonsUpdate2 = _interopRequireDefault(_reactAddonsUpdate);\n\nvar _classnames = require('classnames');\n\nvar _classnames2 = _interopRequireDefault(_classnames);\n\nvar _utils = require('../utils');\n\nrequire('./Nestable.css');\n\nvar _NestableItem = require('./NestableItem');\n\nvar _NestableItem2 = _interopRequireDefault(_NestableItem);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _toConsumableArray(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  } else {\n    return Array.from(arr);\n  }\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar Nestable = function (_Component) {\n  _inherits(Nestable, _Component);\n\n  function Nestable(props) {\n    _classCallCheck(this, Nestable);\n\n    var _this = _possibleConstructorReturn(this, (Nestable.__proto__ || Object.getPrototypeOf(Nestable)).call(this, props));\n\n    _this.collapse = function (itemIds) {\n      var _this$props = _this.props,\n          childrenProp = _this$props.childrenProp,\n          collapsed = _this$props.collapsed;\n      var items = _this.state.items;\n\n      if (itemIds === 'NONE') {\n        _this.setState({\n          collapsedGroups: collapsed ? (0, _utils.getAllNonEmptyNodesIds)(items, childrenProp) : []\n        });\n      } else if (itemIds === 'ALL') {\n        _this.setState({\n          collapsedGroups: collapsed ? [] : (0, _utils.getAllNonEmptyNodesIds)(items, childrenProp)\n        });\n      } else if ((0, _utils.isArray)(itemIds)) {\n        _this.setState({\n          collapsedGroups: (0, _utils.getAllNonEmptyNodesIds)(items, childrenProp).filter(function (id) {\n            return itemIds.indexOf(id) > -1 ^ collapsed;\n          })\n        });\n      }\n    };\n\n    _this.startTrackMouse = function () {\n      document.addEventListener('mousemove', _this.onMouseMove);\n      document.addEventListener('mouseup', _this.onDragEnd);\n      document.addEventListener('keydown', _this.onKeyDown);\n    };\n\n    _this.stopTrackMouse = function () {\n      document.removeEventListener('mousemove', _this.onMouseMove);\n      document.removeEventListener('mouseup', _this.onDragEnd);\n      document.removeEventListener('keydown', _this.onKeyDown);\n      _this.elCopyStyles = null;\n    };\n\n    _this.getItemDepth = function (item) {\n      var childrenProp = _this.props.childrenProp;\n      var level = 1;\n\n      if (item[childrenProp].length > 0) {\n        var childrenDepths = item[childrenProp].map(_this.getItemDepth);\n        level += Math.max.apply(Math, _toConsumableArray(childrenDepths));\n      }\n\n      return level;\n    };\n\n    _this.isCollapsed = function (item) {\n      var collapsed = _this.props.collapsed;\n      var collapsedGroups = _this.state.collapsedGroups;\n      return !!(collapsedGroups.indexOf(item.id) > -1 ^ collapsed);\n    };\n\n    _this.onDragStart = function (e, item) {\n      if (e) {\n        e.preventDefault();\n        e.stopPropagation();\n      }\n\n      _this.el = (0, _utils.closest)(e.target, '.nestable-item');\n\n      _this.startTrackMouse();\n\n      _this.onMouseMove(e);\n\n      _this.setState({\n        dragItem: item,\n        itemsOld: _this.state.items\n      });\n    };\n\n    _this.onDragEnd = function (e, isCancel) {\n      e && e.preventDefault();\n\n      _this.stopTrackMouse();\n\n      _this.el = null;\n      isCancel ? _this.dragRevert() : _this.dragApply();\n    };\n\n    _this.onMouseMove = function (e) {\n      var _this$props2 = _this.props,\n          group = _this$props2.group,\n          threshold = _this$props2.threshold;\n      var dragItem = _this.state.dragItem;\n      var clientX = e.clientX,\n          clientY = e.clientY;\n      var transformProps = (0, _utils.getTransformProps)(clientX, clientY);\n      var elCopy = document.querySelector('.nestable-' + group + ' .nestable-drag-layer > .nestable-list');\n\n      if (!_this.elCopyStyles) {\n        var offset = (0, _utils.getOffsetRect)(_this.el);\n        var scroll = (0, _utils.getTotalScroll)(_this.el);\n        _this.elCopyStyles = _extends({\n          marginTop: offset.top - clientY - scroll.top,\n          marginLeft: offset.left - clientX - scroll.left\n        }, transformProps);\n      } else {\n        _this.elCopyStyles = _extends({}, _this.elCopyStyles, transformProps);\n\n        for (var key in transformProps) {\n          if (transformProps.hasOwnProperty(key)) {\n            elCopy.style[key] = transformProps[key];\n          }\n        }\n\n        var diffX = clientX - _this.mouse.last.x;\n\n        if (diffX >= 0 && _this.mouse.shift.x >= 0 || diffX <= 0 && _this.mouse.shift.x <= 0) {\n          _this.mouse.shift.x += diffX;\n        } else {\n          _this.mouse.shift.x = 0;\n        }\n\n        _this.mouse.last.x = clientX;\n\n        if (Math.abs(_this.mouse.shift.x) > threshold) {\n          if (_this.mouse.shift.x > 0) {\n            _this.tryIncreaseDepth(dragItem);\n          } else {\n            _this.tryDecreaseDepth(dragItem);\n          }\n\n          _this.mouse.shift.x = 0;\n        }\n      }\n    };\n\n    _this.onMouseEnter = function (e, item) {\n      if (e) {\n        e.preventDefault();\n        e.stopPropagation();\n      }\n\n      var _this$props3 = _this.props,\n          collapsed = _this$props3.collapsed,\n          childrenProp = _this$props3.childrenProp;\n      var dragItem = _this.state.dragItem;\n      if (dragItem.id === item.id) return;\n\n      var pathFrom = _this.getPathById(dragItem.id);\n\n      var pathTo = _this.getPathById(item.id); // if collapsed by default\n      // and move last (by count) child\n      // remove parent node from list of open nodes\n\n\n      var collapseProps = {};\n\n      if (collapsed && pathFrom.length > 1) {\n        var parent = _this.getItemByPath(pathFrom.slice(0, -1));\n\n        if (parent[childrenProp].length === 1) {\n          collapseProps = _this.onToggleCollapse(parent, true);\n        }\n      }\n\n      _this.moveItem({\n        dragItem: dragItem,\n        pathFrom: pathFrom,\n        pathTo: pathTo\n      }, collapseProps);\n    };\n\n    _this.onToggleCollapse = function (item, isGetter) {\n      var collapsed = _this.props.collapsed;\n      var collapsedGroups = _this.state.collapsedGroups;\n\n      var isCollapsed = _this.isCollapsed(item);\n\n      var newState = {\n        collapsedGroups: isCollapsed ^ collapsed ? collapsedGroups.filter(function (id) {\n          return id !== item.id;\n        }) : collapsedGroups.concat(item.id)\n      };\n\n      if (isGetter) {\n        return newState;\n      } else {\n        _this.setState(newState);\n      }\n    };\n\n    _this.onKeyDown = function (e) {\n      if (e.which === 27) {\n        // ESC\n        _this.onDragEnd(null, true);\n      }\n    };\n\n    _this.state = {\n      items: [],\n      itemsOld: null,\n      // snap copy in case of canceling drag\n      dragItem: null,\n      isDirty: false,\n      collapsedGroups: []\n    };\n    _this.el = null;\n    _this.elCopyStyles = null;\n    _this.mouse = {\n      last: {\n        x: 0\n      },\n      shift: {\n        x: 0\n      }\n    };\n    return _this;\n  }\n\n  _createClass(Nestable, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var _props = this.props,\n          items = _props.items,\n          childrenProp = _props.childrenProp; // make sure every item has property 'children'\n\n      items = (0, _utils.listWithChildren)(items, childrenProp);\n      this.setState({\n        items: items\n      });\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps) {\n      var _props2 = this.props,\n          itemsNew = _props2.items,\n          childrenProp = _props2.childrenProp;\n      var isPropsUpdated = (0, _reactAddonsShallowCompare2.default)({\n        props: prevProps,\n        state: {}\n      }, this.props, {});\n\n      if (isPropsUpdated) {\n        this.stopTrackMouse();\n        var extra = {};\n\n        if (prevProps.collapsed !== this.props.collapsed) {\n          extra.collapsedGroups = [];\n        }\n\n        this.setState(_extends({\n          items: (0, _utils.listWithChildren)(itemsNew, childrenProp),\n          dragItem: null,\n          isDirty: false\n        }, extra));\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this.stopTrackMouse();\n    } // ––––––––––––––––––––––––––––––––––––\n    // Public Methods\n    // ––––––––––––––––––––––––––––––––––––\n    // ––––––––––––––––––––––––––––––––––––\n    // Methods\n    // ––––––––––––––––––––––––––––––––––––\n\n  }, {\n    key: 'moveItem',\n    value: function moveItem(_ref) {\n      var dragItem = _ref.dragItem,\n          pathFrom = _ref.pathFrom,\n          pathTo = _ref.pathTo;\n      var extraProps = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var _props3 = this.props,\n          childrenProp = _props3.childrenProp,\n          confirmChange = _props3.confirmChange;\n      var dragItemSize = this.getItemDepth(dragItem);\n      var items = this.state.items; // the remove action might affect the next position,\n      // so update next coordinates accordingly\n\n      var realPathTo = this.getRealNextPath(pathFrom, pathTo, dragItemSize);\n      if (realPathTo.length === 0) return; // user can validate every movement\n\n      var destinationPath = realPathTo.length > pathTo.length ? pathTo : pathTo.slice(0, -1);\n      var destinationParent = this.getItemByPath(destinationPath);\n      if (!confirmChange(dragItem, destinationParent)) return;\n      var removePath = this.getSplicePath(pathFrom, {\n        numToRemove: 1,\n        childrenProp: childrenProp\n      });\n      var insertPath = this.getSplicePath(realPathTo, {\n        numToRemove: 0,\n        itemsToInsert: [dragItem],\n        childrenProp: childrenProp\n      });\n      items = (0, _reactAddonsUpdate2.default)(items, removePath);\n      items = (0, _reactAddonsUpdate2.default)(items, insertPath);\n      this.setState(_extends({\n        items: items,\n        isDirty: true\n      }, extraProps));\n    }\n  }, {\n    key: 'tryIncreaseDepth',\n    value: function tryIncreaseDepth(dragItem) {\n      var _props4 = this.props,\n          maxDepth = _props4.maxDepth,\n          childrenProp = _props4.childrenProp,\n          collapsed = _props4.collapsed;\n      var pathFrom = this.getPathById(dragItem.id);\n      var itemIndex = pathFrom[pathFrom.length - 1];\n      var newDepth = pathFrom.length + this.getItemDepth(dragItem); // has previous sibling and isn't at max depth\n\n      if (itemIndex > 0 && newDepth <= maxDepth) {\n        var prevSibling = this.getItemByPath(pathFrom.slice(0, -1).concat(itemIndex - 1)); // previous sibling is not collapsed\n\n        if (!prevSibling[childrenProp].length || !this.isCollapsed(prevSibling)) {\n          var pathTo = pathFrom.slice(0, -1).concat(itemIndex - 1).concat(prevSibling[childrenProp].length); // if collapsed by default\n          // and was no children here\n          // open this node\n\n          var collapseProps = {};\n\n          if (collapsed && !prevSibling[childrenProp].length) {\n            collapseProps = this.onToggleCollapse(prevSibling, true);\n          }\n\n          this.moveItem({\n            dragItem: dragItem,\n            pathFrom: pathFrom,\n            pathTo: pathTo\n          }, collapseProps);\n        }\n      }\n    }\n  }, {\n    key: 'tryDecreaseDepth',\n    value: function tryDecreaseDepth(dragItem) {\n      var _props5 = this.props,\n          childrenProp = _props5.childrenProp,\n          collapsed = _props5.collapsed;\n      var pathFrom = this.getPathById(dragItem.id);\n      var itemIndex = pathFrom[pathFrom.length - 1]; // has parent\n\n      if (pathFrom.length > 1) {\n        var parent = this.getItemByPath(pathFrom.slice(0, -1)); // is last (by order) item in array\n\n        if (itemIndex + 1 === parent[childrenProp].length) {\n          var pathTo = pathFrom.slice(0, -1);\n          pathTo[pathTo.length - 1] += 1; // if collapsed by default\n          // and is last (by count) item in array\n          // remove this node from list of open nodes\n\n          var collapseProps = {};\n\n          if (collapsed && parent[childrenProp].length === 1) {\n            collapseProps = this.onToggleCollapse(parent, true);\n          }\n\n          this.moveItem({\n            dragItem: dragItem,\n            pathFrom: pathFrom,\n            pathTo: pathTo\n          }, collapseProps);\n        }\n      }\n    }\n  }, {\n    key: 'dragApply',\n    value: function dragApply() {\n      var onChange = this.props.onChange;\n      var _state = this.state,\n          items = _state.items,\n          isDirty = _state.isDirty,\n          dragItem = _state.dragItem;\n      this.setState({\n        itemsOld: null,\n        dragItem: null,\n        isDirty: false\n      });\n      onChange && isDirty && onChange(items, dragItem);\n    }\n  }, {\n    key: 'dragRevert',\n    value: function dragRevert() {\n      var itemsOld = this.state.itemsOld;\n      this.setState({\n        items: itemsOld,\n        itemsOld: null,\n        dragItem: null,\n        isDirty: false\n      });\n    } // ––––––––––––––––––––––––––––––––––––\n    // Getter methods\n    // ––––––––––––––––––––––––––––––––––––\n\n  }, {\n    key: 'getPathById',\n    value: function getPathById(id) {\n      var _this2 = this;\n\n      var items = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.state.items;\n      var childrenProp = this.props.childrenProp;\n      var path = [];\n      items.every(function (item, i) {\n        if (item.id === id) {\n          path.push(i);\n        } else if (item[childrenProp]) {\n          var childrenPath = _this2.getPathById(id, item[childrenProp]);\n\n          if (childrenPath.length) {\n            path = path.concat(i).concat(childrenPath);\n          }\n        }\n\n        return path.length === 0;\n      });\n      return path;\n    }\n  }, {\n    key: 'getItemByPath',\n    value: function getItemByPath(path) {\n      var items = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.state.items;\n      var childrenProp = this.props.childrenProp;\n      var item = null;\n      path.forEach(function (index) {\n        var list = item ? item[childrenProp] : items;\n        item = list[index];\n      });\n      return item;\n    }\n  }, {\n    key: 'getSplicePath',\n    value: function getSplicePath(path) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var splicePath = {};\n      var numToRemove = options.numToRemove || 0;\n      var itemsToInsert = options.itemsToInsert || [];\n      var lastIndex = path.length - 1;\n      var currentPath = splicePath;\n      path.forEach(function (index, i) {\n        if (i === lastIndex) {\n          currentPath.$splice = [[index, numToRemove].concat(_toConsumableArray(itemsToInsert))];\n        } else {\n          var nextPath = {};\n          currentPath[index] = _defineProperty({}, options.childrenProp, nextPath);\n          currentPath = nextPath;\n        }\n      });\n      return splicePath;\n    }\n  }, {\n    key: 'getRealNextPath',\n    value: function getRealNextPath(prevPath, nextPath, dragItemSize) {\n      var _props6 = this.props,\n          childrenProp = _props6.childrenProp,\n          maxDepth = _props6.maxDepth;\n      var ppLastIndex = prevPath.length - 1;\n      var npLastIndex = nextPath.length - 1;\n      var newDepth = nextPath.length + dragItemSize - 1;\n\n      if (prevPath.length < nextPath.length) {\n        // move into depth\n        var wasShifted = false; // if new depth exceeds max, try to put after item instead of into item\n\n        if (newDepth > maxDepth && nextPath.length) {\n          return this.getRealNextPath(prevPath, nextPath.slice(0, -1), dragItemSize);\n        }\n\n        return nextPath.map(function (nextIndex, i) {\n          if (wasShifted) {\n            return i === npLastIndex ? nextIndex + 1 : nextIndex;\n          }\n\n          if (typeof prevPath[i] !== 'number') {\n            return nextIndex;\n          }\n\n          if (nextPath[i] > prevPath[i] && i === ppLastIndex) {\n            wasShifted = true;\n            return nextIndex - 1;\n          }\n\n          return nextIndex;\n        });\n      } else if (prevPath.length === nextPath.length) {\n        // if move bottom + move to item with children --> make it a first child instead of swap\n        if (nextPath[npLastIndex] > prevPath[npLastIndex]) {\n          var target = this.getItemByPath(nextPath);\n\n          if (newDepth < maxDepth && target[childrenProp] && target[childrenProp].length && !this.isCollapsed(target)) {\n            return nextPath.slice(0, -1).concat(nextPath[npLastIndex] - 1).concat(0);\n          }\n        }\n      }\n\n      return nextPath;\n    }\n  }, {\n    key: 'getItemOptions',\n    value: function getItemOptions() {\n      var _props7 = this.props,\n          renderItem = _props7.renderItem,\n          renderCollapseIcon = _props7.renderCollapseIcon,\n          handler = _props7.handler,\n          childrenProp = _props7.childrenProp;\n      var dragItem = this.state.dragItem;\n      return {\n        dragItem: dragItem,\n        childrenProp: childrenProp,\n        renderItem: renderItem,\n        renderCollapseIcon: renderCollapseIcon,\n        handler: handler,\n        onDragStart: this.onDragStart,\n        onMouseEnter: this.onMouseEnter,\n        isCollapsed: this.isCollapsed,\n        onToggleCollapse: this.onToggleCollapse\n      };\n    } // ––––––––––––––––––––––––––––––––––––\n    // Click handlers or event handlers\n    // ––––––––––––––––––––––––––––––––––––\n\n  }, {\n    key: 'renderDragLayer',\n    // ––––––––––––––––––––––––––––––––––––\n    // Render methods\n    // ––––––––––––––––––––––––––––––––––––\n    value: function renderDragLayer() {\n      var group = this.props.group;\n      var dragItem = this.state.dragItem;\n      var el = document.querySelector('.nestable-' + group + ' .nestable-item-' + dragItem.id);\n      var listStyles = {};\n\n      if (el) {\n        listStyles.width = el.clientWidth;\n      }\n\n      if (this.elCopyStyles) {\n        listStyles = _extends({}, listStyles, this.elCopyStyles);\n      }\n\n      var options = this.getItemOptions();\n      return _react2.default.createElement('div', {\n        className: 'nestable-drag-layer'\n      }, _react2.default.createElement('ol', {\n        className: 'nestable-list',\n        style: listStyles\n      }, _react2.default.createElement(_NestableItem2.default, {\n        item: dragItem,\n        options: options,\n        isCopy: true\n      })));\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _props8 = this.props,\n          group = _props8.group,\n          className = _props8.className;\n      var _state2 = this.state,\n          items = _state2.items,\n          dragItem = _state2.dragItem;\n      var options = this.getItemOptions();\n      return _react2.default.createElement('div', {\n        className: (0, _classnames2.default)(className, 'nestable', 'nestable-' + group, {\n          'is-drag-active': dragItem\n        })\n      }, _react2.default.createElement('ol', {\n        className: 'nestable-list nestable-group'\n      }, items.map(function (item, i) {\n        return _react2.default.createElement(_NestableItem2.default, {\n          key: i,\n          index: i,\n          item: item,\n          options: options\n        });\n      })), dragItem && this.renderDragLayer());\n    }\n  }]);\n\n  return Nestable;\n}(_react.Component);\n\nNestable.propTypes = {\n  className: _propTypes2.default.string,\n  items: _propTypes2.default.arrayOf(_propTypes2.default.shape({\n    id: _propTypes2.default.any.isRequired\n  })),\n  threshold: _propTypes2.default.number,\n  maxDepth: _propTypes2.default.number,\n  collapsed: _propTypes2.default.bool,\n  group: _propTypes2.default.oneOfType([_propTypes2.default.number, _propTypes2.default.string]),\n  childrenProp: _propTypes2.default.string,\n  renderItem: _propTypes2.default.func,\n  renderCollapseIcon: _propTypes2.default.func,\n  handler: _propTypes2.default.node,\n  onChange: _propTypes2.default.func,\n  confirmChange: _propTypes2.default.func\n};\nNestable.defaultProps = {\n  items: [],\n  threshold: 30,\n  maxDepth: 10,\n  collapsed: false,\n  group: Math.random().toString(36).slice(2),\n  childrenProp: 'children',\n  renderItem: function renderItem(_ref2) {\n    var item = _ref2.item;\n    return item.toString();\n  },\n  onChange: function onChange() {},\n  confirmChange: function confirmChange() {\n    return true;\n  }\n};\nexports.default = Nestable;","map":{"version":3,"sources":["C:/Users/Power GSM/Desktop/React-Fito-v1.0-9-April-2021V/React-Fito-v1.0-9-April-2021V/react-fito/node_modules/react-nestable/dist/Nestable/Nestable.js"],"names":["Object","defineProperty","exports","value","_extends","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_createClass","defineProperties","props","descriptor","enumerable","configurable","writable","Constructor","protoProps","staticProps","_react","require","_react2","_interopRequireDefault","_propTypes","_propTypes2","_reactAddonsShallowCompare","_reactAddonsShallowCompare2","_reactAddonsUpdate","_reactAddonsUpdate2","_classnames","_classnames2","_utils","_NestableItem","_NestableItem2","obj","__esModule","default","_defineProperty","_toConsumableArray","arr","Array","isArray","arr2","from","_classCallCheck","instance","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","Nestable","_Component","_this","getPrototypeOf","collapse","itemIds","_this$props","childrenProp","collapsed","items","state","setState","collapsedGroups","getAllNonEmptyNodesIds","filter","id","indexOf","startTrackMouse","document","addEventListener","onMouseMove","onDragEnd","onKeyDown","stopTrackMouse","removeEventListener","elCopyStyles","getItemDepth","item","level","childrenDepths","map","Math","max","apply","isCollapsed","onDragStart","e","preventDefault","stopPropagation","el","closest","dragItem","itemsOld","isCancel","dragRevert","dragApply","_this$props2","group","threshold","clientX","clientY","transformProps","getTransformProps","elCopy","querySelector","offset","getOffsetRect","scroll","getTotalScroll","marginTop","top","marginLeft","left","style","diffX","mouse","last","x","shift","abs","tryIncreaseDepth","tryDecreaseDepth","onMouseEnter","_this$props3","pathFrom","getPathById","pathTo","collapseProps","parent","getItemByPath","slice","onToggleCollapse","moveItem","isGetter","newState","concat","which","isDirty","componentDidMount","_props","listWithChildren","componentDidUpdate","prevProps","_props2","itemsNew","isPropsUpdated","extra","componentWillUnmount","_ref","extraProps","undefined","_props3","confirmChange","dragItemSize","realPathTo","getRealNextPath","destinationPath","destinationParent","removePath","getSplicePath","numToRemove","insertPath","itemsToInsert","_props4","maxDepth","itemIndex","newDepth","prevSibling","_props5","onChange","_state","_this2","path","every","push","childrenPath","forEach","index","list","options","splicePath","lastIndex","currentPath","$splice","nextPath","prevPath","_props6","ppLastIndex","npLastIndex","wasShifted","nextIndex","getItemOptions","_props7","renderItem","renderCollapseIcon","handler","renderDragLayer","listStyles","width","clientWidth","createElement","className","isCopy","render","_props8","_state2","Component","propTypes","string","arrayOf","shape","any","isRequired","number","bool","oneOfType","func","node","defaultProps","random","toString","_ref2"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _reactAddonsShallowCompare = require('react-addons-shallow-compare');\n\nvar _reactAddonsShallowCompare2 = _interopRequireDefault(_reactAddonsShallowCompare);\n\nvar _reactAddonsUpdate = require('react-addons-update');\n\nvar _reactAddonsUpdate2 = _interopRequireDefault(_reactAddonsUpdate);\n\nvar _classnames = require('classnames');\n\nvar _classnames2 = _interopRequireDefault(_classnames);\n\nvar _utils = require('../utils');\n\nrequire('./Nestable.css');\n\nvar _NestableItem = require('./NestableItem');\n\nvar _NestableItem2 = _interopRequireDefault(_NestableItem);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Nestable = function (_Component) {\n  _inherits(Nestable, _Component);\n\n  function Nestable(props) {\n    _classCallCheck(this, Nestable);\n\n    var _this = _possibleConstructorReturn(this, (Nestable.__proto__ || Object.getPrototypeOf(Nestable)).call(this, props));\n\n    _this.collapse = function (itemIds) {\n      var _this$props = _this.props,\n          childrenProp = _this$props.childrenProp,\n          collapsed = _this$props.collapsed;\n      var items = _this.state.items;\n\n\n      if (itemIds === 'NONE') {\n        _this.setState({\n          collapsedGroups: collapsed ? (0, _utils.getAllNonEmptyNodesIds)(items, childrenProp) : []\n        });\n      } else if (itemIds === 'ALL') {\n        _this.setState({\n          collapsedGroups: collapsed ? [] : (0, _utils.getAllNonEmptyNodesIds)(items, childrenProp)\n        });\n      } else if ((0, _utils.isArray)(itemIds)) {\n        _this.setState({\n          collapsedGroups: (0, _utils.getAllNonEmptyNodesIds)(items, childrenProp).filter(function (id) {\n            return itemIds.indexOf(id) > -1 ^ collapsed;\n          })\n        });\n      }\n    };\n\n    _this.startTrackMouse = function () {\n      document.addEventListener('mousemove', _this.onMouseMove);\n      document.addEventListener('mouseup', _this.onDragEnd);\n      document.addEventListener('keydown', _this.onKeyDown);\n    };\n\n    _this.stopTrackMouse = function () {\n      document.removeEventListener('mousemove', _this.onMouseMove);\n      document.removeEventListener('mouseup', _this.onDragEnd);\n      document.removeEventListener('keydown', _this.onKeyDown);\n      _this.elCopyStyles = null;\n    };\n\n    _this.getItemDepth = function (item) {\n      var childrenProp = _this.props.childrenProp;\n\n      var level = 1;\n\n      if (item[childrenProp].length > 0) {\n        var childrenDepths = item[childrenProp].map(_this.getItemDepth);\n        level += Math.max.apply(Math, _toConsumableArray(childrenDepths));\n      }\n\n      return level;\n    };\n\n    _this.isCollapsed = function (item) {\n      var collapsed = _this.props.collapsed;\n      var collapsedGroups = _this.state.collapsedGroups;\n\n\n      return !!(collapsedGroups.indexOf(item.id) > -1 ^ collapsed);\n    };\n\n    _this.onDragStart = function (e, item) {\n      if (e) {\n        e.preventDefault();\n        e.stopPropagation();\n      }\n\n      _this.el = (0, _utils.closest)(e.target, '.nestable-item');\n\n      _this.startTrackMouse();\n      _this.onMouseMove(e);\n\n      _this.setState({\n        dragItem: item,\n        itemsOld: _this.state.items\n      });\n    };\n\n    _this.onDragEnd = function (e, isCancel) {\n      e && e.preventDefault();\n\n      _this.stopTrackMouse();\n      _this.el = null;\n\n      isCancel ? _this.dragRevert() : _this.dragApply();\n    };\n\n    _this.onMouseMove = function (e) {\n      var _this$props2 = _this.props,\n          group = _this$props2.group,\n          threshold = _this$props2.threshold;\n      var dragItem = _this.state.dragItem;\n      var clientX = e.clientX,\n          clientY = e.clientY;\n\n      var transformProps = (0, _utils.getTransformProps)(clientX, clientY);\n      var elCopy = document.querySelector('.nestable-' + group + ' .nestable-drag-layer > .nestable-list');\n\n      if (!_this.elCopyStyles) {\n        var offset = (0, _utils.getOffsetRect)(_this.el);\n        var scroll = (0, _utils.getTotalScroll)(_this.el);\n\n        _this.elCopyStyles = _extends({\n          marginTop: offset.top - clientY - scroll.top,\n          marginLeft: offset.left - clientX - scroll.left\n        }, transformProps);\n      } else {\n        _this.elCopyStyles = _extends({}, _this.elCopyStyles, transformProps);\n        for (var key in transformProps) {\n          if (transformProps.hasOwnProperty(key)) {\n            elCopy.style[key] = transformProps[key];\n          }\n        }\n\n        var diffX = clientX - _this.mouse.last.x;\n        if (diffX >= 0 && _this.mouse.shift.x >= 0 || diffX <= 0 && _this.mouse.shift.x <= 0) {\n          _this.mouse.shift.x += diffX;\n        } else {\n          _this.mouse.shift.x = 0;\n        }\n        _this.mouse.last.x = clientX;\n\n        if (Math.abs(_this.mouse.shift.x) > threshold) {\n          if (_this.mouse.shift.x > 0) {\n            _this.tryIncreaseDepth(dragItem);\n          } else {\n            _this.tryDecreaseDepth(dragItem);\n          }\n\n          _this.mouse.shift.x = 0;\n        }\n      }\n    };\n\n    _this.onMouseEnter = function (e, item) {\n      if (e) {\n        e.preventDefault();\n        e.stopPropagation();\n      }\n\n      var _this$props3 = _this.props,\n          collapsed = _this$props3.collapsed,\n          childrenProp = _this$props3.childrenProp;\n      var dragItem = _this.state.dragItem;\n\n      if (dragItem.id === item.id) return;\n\n      var pathFrom = _this.getPathById(dragItem.id);\n      var pathTo = _this.getPathById(item.id);\n\n      // if collapsed by default\n      // and move last (by count) child\n      // remove parent node from list of open nodes\n      var collapseProps = {};\n      if (collapsed && pathFrom.length > 1) {\n        var parent = _this.getItemByPath(pathFrom.slice(0, -1));\n        if (parent[childrenProp].length === 1) {\n          collapseProps = _this.onToggleCollapse(parent, true);\n        }\n      }\n\n      _this.moveItem({ dragItem: dragItem, pathFrom: pathFrom, pathTo: pathTo }, collapseProps);\n    };\n\n    _this.onToggleCollapse = function (item, isGetter) {\n      var collapsed = _this.props.collapsed;\n      var collapsedGroups = _this.state.collapsedGroups;\n\n      var isCollapsed = _this.isCollapsed(item);\n\n      var newState = {\n        collapsedGroups: isCollapsed ^ collapsed ? collapsedGroups.filter(function (id) {\n          return id !== item.id;\n        }) : collapsedGroups.concat(item.id)\n      };\n\n      if (isGetter) {\n        return newState;\n      } else {\n        _this.setState(newState);\n      }\n    };\n\n    _this.onKeyDown = function (e) {\n      if (e.which === 27) {\n        // ESC\n        _this.onDragEnd(null, true);\n      }\n    };\n\n    _this.state = {\n      items: [],\n      itemsOld: null, // snap copy in case of canceling drag\n      dragItem: null,\n      isDirty: false,\n      collapsedGroups: []\n    };\n\n    _this.el = null;\n    _this.elCopyStyles = null;\n    _this.mouse = {\n      last: { x: 0 },\n      shift: { x: 0 }\n    };\n    return _this;\n  }\n\n  _createClass(Nestable, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var _props = this.props,\n          items = _props.items,\n          childrenProp = _props.childrenProp;\n\n      // make sure every item has property 'children'\n\n      items = (0, _utils.listWithChildren)(items, childrenProp);\n\n      this.setState({ items: items });\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps) {\n      var _props2 = this.props,\n          itemsNew = _props2.items,\n          childrenProp = _props2.childrenProp;\n\n      var isPropsUpdated = (0, _reactAddonsShallowCompare2.default)({ props: prevProps, state: {} }, this.props, {});\n\n      if (isPropsUpdated) {\n        this.stopTrackMouse();\n\n        var extra = {};\n\n        if (prevProps.collapsed !== this.props.collapsed) {\n          extra.collapsedGroups = [];\n        }\n\n        this.setState(_extends({\n          items: (0, _utils.listWithChildren)(itemsNew, childrenProp),\n          dragItem: null,\n          isDirty: false\n        }, extra));\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this.stopTrackMouse();\n    }\n\n    // ––––––––––––––––––––––––––––––––––––\n    // Public Methods\n    // ––––––––––––––––––––––––––––––––––––\n\n\n    // ––––––––––––––––––––––––––––––––––––\n    // Methods\n    // ––––––––––––––––––––––––––––––––––––\n\n  }, {\n    key: 'moveItem',\n    value: function moveItem(_ref) {\n      var dragItem = _ref.dragItem,\n          pathFrom = _ref.pathFrom,\n          pathTo = _ref.pathTo;\n      var extraProps = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var _props3 = this.props,\n          childrenProp = _props3.childrenProp,\n          confirmChange = _props3.confirmChange;\n\n      var dragItemSize = this.getItemDepth(dragItem);\n      var items = this.state.items;\n\n      // the remove action might affect the next position,\n      // so update next coordinates accordingly\n\n      var realPathTo = this.getRealNextPath(pathFrom, pathTo, dragItemSize);\n\n      if (realPathTo.length === 0) return;\n\n      // user can validate every movement\n      var destinationPath = realPathTo.length > pathTo.length ? pathTo : pathTo.slice(0, -1);\n      var destinationParent = this.getItemByPath(destinationPath);\n      if (!confirmChange(dragItem, destinationParent)) return;\n\n      var removePath = this.getSplicePath(pathFrom, {\n        numToRemove: 1,\n        childrenProp: childrenProp\n      });\n\n      var insertPath = this.getSplicePath(realPathTo, {\n        numToRemove: 0,\n        itemsToInsert: [dragItem],\n        childrenProp: childrenProp\n      });\n\n      items = (0, _reactAddonsUpdate2.default)(items, removePath);\n      items = (0, _reactAddonsUpdate2.default)(items, insertPath);\n\n      this.setState(_extends({\n        items: items,\n        isDirty: true\n      }, extraProps));\n    }\n  }, {\n    key: 'tryIncreaseDepth',\n    value: function tryIncreaseDepth(dragItem) {\n      var _props4 = this.props,\n          maxDepth = _props4.maxDepth,\n          childrenProp = _props4.childrenProp,\n          collapsed = _props4.collapsed;\n\n      var pathFrom = this.getPathById(dragItem.id);\n      var itemIndex = pathFrom[pathFrom.length - 1];\n      var newDepth = pathFrom.length + this.getItemDepth(dragItem);\n\n      // has previous sibling and isn't at max depth\n      if (itemIndex > 0 && newDepth <= maxDepth) {\n        var prevSibling = this.getItemByPath(pathFrom.slice(0, -1).concat(itemIndex - 1));\n\n        // previous sibling is not collapsed\n        if (!prevSibling[childrenProp].length || !this.isCollapsed(prevSibling)) {\n          var pathTo = pathFrom.slice(0, -1).concat(itemIndex - 1).concat(prevSibling[childrenProp].length);\n\n          // if collapsed by default\n          // and was no children here\n          // open this node\n          var collapseProps = {};\n          if (collapsed && !prevSibling[childrenProp].length) {\n            collapseProps = this.onToggleCollapse(prevSibling, true);\n          }\n\n          this.moveItem({ dragItem: dragItem, pathFrom: pathFrom, pathTo: pathTo }, collapseProps);\n        }\n      }\n    }\n  }, {\n    key: 'tryDecreaseDepth',\n    value: function tryDecreaseDepth(dragItem) {\n      var _props5 = this.props,\n          childrenProp = _props5.childrenProp,\n          collapsed = _props5.collapsed;\n\n      var pathFrom = this.getPathById(dragItem.id);\n      var itemIndex = pathFrom[pathFrom.length - 1];\n\n      // has parent\n      if (pathFrom.length > 1) {\n        var parent = this.getItemByPath(pathFrom.slice(0, -1));\n\n        // is last (by order) item in array\n        if (itemIndex + 1 === parent[childrenProp].length) {\n          var pathTo = pathFrom.slice(0, -1);\n          pathTo[pathTo.length - 1] += 1;\n\n          // if collapsed by default\n          // and is last (by count) item in array\n          // remove this node from list of open nodes\n          var collapseProps = {};\n          if (collapsed && parent[childrenProp].length === 1) {\n            collapseProps = this.onToggleCollapse(parent, true);\n          }\n\n          this.moveItem({ dragItem: dragItem, pathFrom: pathFrom, pathTo: pathTo }, collapseProps);\n        }\n      }\n    }\n  }, {\n    key: 'dragApply',\n    value: function dragApply() {\n      var onChange = this.props.onChange;\n      var _state = this.state,\n          items = _state.items,\n          isDirty = _state.isDirty,\n          dragItem = _state.dragItem;\n\n\n      this.setState({\n        itemsOld: null,\n        dragItem: null,\n        isDirty: false\n      });\n\n      onChange && isDirty && onChange(items, dragItem);\n    }\n  }, {\n    key: 'dragRevert',\n    value: function dragRevert() {\n      var itemsOld = this.state.itemsOld;\n\n\n      this.setState({\n        items: itemsOld,\n        itemsOld: null,\n        dragItem: null,\n        isDirty: false\n      });\n    }\n\n    // ––––––––––––––––––––––––––––––––––––\n    // Getter methods\n    // ––––––––––––––––––––––––––––––––––––\n\n  }, {\n    key: 'getPathById',\n    value: function getPathById(id) {\n      var _this2 = this;\n\n      var items = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.state.items;\n      var childrenProp = this.props.childrenProp;\n\n      var path = [];\n\n      items.every(function (item, i) {\n        if (item.id === id) {\n          path.push(i);\n        } else if (item[childrenProp]) {\n          var childrenPath = _this2.getPathById(id, item[childrenProp]);\n\n          if (childrenPath.length) {\n            path = path.concat(i).concat(childrenPath);\n          }\n        }\n\n        return path.length === 0;\n      });\n\n      return path;\n    }\n  }, {\n    key: 'getItemByPath',\n    value: function getItemByPath(path) {\n      var items = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.state.items;\n      var childrenProp = this.props.childrenProp;\n\n      var item = null;\n\n      path.forEach(function (index) {\n        var list = item ? item[childrenProp] : items;\n        item = list[index];\n      });\n\n      return item;\n    }\n  }, {\n    key: 'getSplicePath',\n    value: function getSplicePath(path) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      var splicePath = {};\n      var numToRemove = options.numToRemove || 0;\n      var itemsToInsert = options.itemsToInsert || [];\n      var lastIndex = path.length - 1;\n      var currentPath = splicePath;\n\n      path.forEach(function (index, i) {\n        if (i === lastIndex) {\n          currentPath.$splice = [[index, numToRemove].concat(_toConsumableArray(itemsToInsert))];\n        } else {\n          var nextPath = {};\n          currentPath[index] = _defineProperty({}, options.childrenProp, nextPath);\n          currentPath = nextPath;\n        }\n      });\n\n      return splicePath;\n    }\n  }, {\n    key: 'getRealNextPath',\n    value: function getRealNextPath(prevPath, nextPath, dragItemSize) {\n      var _props6 = this.props,\n          childrenProp = _props6.childrenProp,\n          maxDepth = _props6.maxDepth;\n\n      var ppLastIndex = prevPath.length - 1;\n      var npLastIndex = nextPath.length - 1;\n      var newDepth = nextPath.length + dragItemSize - 1;\n\n      if (prevPath.length < nextPath.length) {\n        // move into depth\n        var wasShifted = false;\n\n        // if new depth exceeds max, try to put after item instead of into item\n        if (newDepth > maxDepth && nextPath.length) {\n          return this.getRealNextPath(prevPath, nextPath.slice(0, -1), dragItemSize);\n        }\n\n        return nextPath.map(function (nextIndex, i) {\n          if (wasShifted) {\n            return i === npLastIndex ? nextIndex + 1 : nextIndex;\n          }\n\n          if (typeof prevPath[i] !== 'number') {\n            return nextIndex;\n          }\n\n          if (nextPath[i] > prevPath[i] && i === ppLastIndex) {\n            wasShifted = true;\n            return nextIndex - 1;\n          }\n\n          return nextIndex;\n        });\n      } else if (prevPath.length === nextPath.length) {\n        // if move bottom + move to item with children --> make it a first child instead of swap\n        if (nextPath[npLastIndex] > prevPath[npLastIndex]) {\n          var target = this.getItemByPath(nextPath);\n\n          if (newDepth < maxDepth && target[childrenProp] && target[childrenProp].length && !this.isCollapsed(target)) {\n            return nextPath.slice(0, -1).concat(nextPath[npLastIndex] - 1).concat(0);\n          }\n        }\n      }\n\n      return nextPath;\n    }\n  }, {\n    key: 'getItemOptions',\n    value: function getItemOptions() {\n      var _props7 = this.props,\n          renderItem = _props7.renderItem,\n          renderCollapseIcon = _props7.renderCollapseIcon,\n          handler = _props7.handler,\n          childrenProp = _props7.childrenProp;\n      var dragItem = this.state.dragItem;\n\n\n      return {\n        dragItem: dragItem,\n        childrenProp: childrenProp,\n        renderItem: renderItem,\n        renderCollapseIcon: renderCollapseIcon,\n        handler: handler,\n\n        onDragStart: this.onDragStart,\n        onMouseEnter: this.onMouseEnter,\n        isCollapsed: this.isCollapsed,\n        onToggleCollapse: this.onToggleCollapse\n      };\n    }\n\n    // ––––––––––––––––––––––––––––––––––––\n    // Click handlers or event handlers\n    // ––––––––––––––––––––––––––––––––––––\n\n  }, {\n    key: 'renderDragLayer',\n\n\n    // ––––––––––––––––––––––––––––––––––––\n    // Render methods\n    // ––––––––––––––––––––––––––––––––––––\n    value: function renderDragLayer() {\n      var group = this.props.group;\n      var dragItem = this.state.dragItem;\n\n      var el = document.querySelector('.nestable-' + group + ' .nestable-item-' + dragItem.id);\n\n      var listStyles = {};\n      if (el) {\n        listStyles.width = el.clientWidth;\n      }\n      if (this.elCopyStyles) {\n        listStyles = _extends({}, listStyles, this.elCopyStyles);\n      }\n\n      var options = this.getItemOptions();\n\n      return _react2.default.createElement(\n        'div',\n        { className: 'nestable-drag-layer' },\n        _react2.default.createElement(\n          'ol',\n          { className: 'nestable-list', style: listStyles },\n          _react2.default.createElement(_NestableItem2.default, {\n            item: dragItem,\n            options: options,\n            isCopy: true\n          })\n        )\n      );\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _props8 = this.props,\n          group = _props8.group,\n          className = _props8.className;\n      var _state2 = this.state,\n          items = _state2.items,\n          dragItem = _state2.dragItem;\n\n      var options = this.getItemOptions();\n\n      return _react2.default.createElement(\n        'div',\n        { className: (0, _classnames2.default)(className, 'nestable', 'nestable-' + group, { 'is-drag-active': dragItem }) },\n        _react2.default.createElement(\n          'ol',\n          { className: 'nestable-list nestable-group' },\n          items.map(function (item, i) {\n            return _react2.default.createElement(_NestableItem2.default, {\n              key: i,\n              index: i,\n              item: item,\n              options: options\n            });\n          })\n        ),\n        dragItem && this.renderDragLayer()\n      );\n    }\n  }]);\n\n  return Nestable;\n}(_react.Component);\n\nNestable.propTypes = {\n  className: _propTypes2.default.string,\n  items: _propTypes2.default.arrayOf(_propTypes2.default.shape({\n    id: _propTypes2.default.any.isRequired\n  })),\n  threshold: _propTypes2.default.number,\n  maxDepth: _propTypes2.default.number,\n  collapsed: _propTypes2.default.bool,\n  group: _propTypes2.default.oneOfType([_propTypes2.default.number, _propTypes2.default.string]),\n  childrenProp: _propTypes2.default.string,\n  renderItem: _propTypes2.default.func,\n  renderCollapseIcon: _propTypes2.default.func,\n  handler: _propTypes2.default.node,\n  onChange: _propTypes2.default.func,\n  confirmChange: _propTypes2.default.func\n};\nNestable.defaultProps = {\n  items: [],\n  threshold: 30,\n  maxDepth: 10,\n  collapsed: false,\n  group: Math.random().toString(36).slice(2),\n  childrenProp: 'children',\n  renderItem: function renderItem(_ref2) {\n    var item = _ref2.item;\n    return item.toString();\n  },\n  onChange: function onChange() {},\n  confirmChange: function confirmChange() {\n    return true;\n  }\n};\nexports.default = Nestable;"]},"metadata":{},"sourceType":"script"}