{"ast":null,"code":"import { measureText, TextOption, renderTextElement, CircleOption, PathOption, RectOption } from '../../smithchart/utils/helper';\nimport { SmithchartRect, LegendSeries } from '../../smithchart/utils/utils';\nimport { legendRender } from '../model/constant';\n/* tslint:disable:no-string-literal */\n\nvar SmithchartLegend =\n/** @class */\nfunction () {\n  function SmithchartLegend() {\n    this.legendSeries = [];\n  }\n\n  SmithchartLegend.prototype.renderLegend = function (smithchart) {\n    this.calculateLegendBounds(smithchart);\n\n    this._drawLegend(smithchart);\n\n    return this.legendActualBounds;\n  };\n\n  SmithchartLegend.prototype.calculateLegendBounds = function (smithchart) {\n    var legendSeries = new LegendSeries();\n    this.legendSeries = [];\n    var padding = 10;\n    var legend = smithchart.legendSettings;\n    var legendSizeHeight = legend.height;\n    var legendSizeWidth = legend.width;\n    var itemPadding = legend.itemPadding > 0 ? legend.itemPadding : 0;\n    var position = legend.position.toLowerCase();\n    var font = legend.title.textStyle;\n    var width = 0;\n    var height = 0;\n    var legendItemWidth = 0;\n    var legendItemHeight = 0;\n    var legendHeight = 0;\n    var svgObjectWidth = smithchart.availableSize.width - (smithchart.elementSpacing * 4 - legend.border.width * 2 + smithchart.border.width * 2);\n    var svgObjectHeight = smithchart.availableSize.height - (smithchart.elementSpacing * 4 - legend.border.width * 2 + smithchart.border.width * 2);\n    var rowCount = legend.rowCount;\n    var columnCount = legend.columnCount;\n    var titleSize = measureText(smithchart.legendSettings['title']['text'], font);\n    var maxRowWidth = 0;\n    var totalRowHeight = 0;\n    var curRowWidth = 0;\n    var curRowHeight = 0;\n    var allowItems;\n    var itemsCountRow = 0;\n    var length = smithchart.series.length;\n    var legendBounds;\n\n    if (smithchart.legendSettings.visible && length !== 0) {\n      if (position === 'bottom' || position === 'top' || position === 'custom') {\n        if (rowCount && columnCount && rowCount <= columnCount) {\n          rowCount = length / columnCount;\n        } else if (rowCount == null && columnCount != null) {\n          rowCount = length / columnCount;\n        } else if (rowCount == null && columnCount == null) {\n          rowCount = 1;\n        }\n\n        if (rowCount) {\n          allowItems = Math.ceil(length / rowCount);\n        }\n      } else {\n        if (rowCount && columnCount && rowCount <= columnCount) {\n          columnCount = length / rowCount;\n        } else if (rowCount != null && columnCount == null) {\n          columnCount = length / rowCount;\n        } else if (rowCount == null && columnCount == null) {\n          columnCount = 1;\n        }\n\n        if (columnCount) {\n          allowItems = columnCount;\n        }\n      }\n\n      for (var i = 0; i < length; i++) {\n        this.legendSeries.push({\n          text: smithchart.series[i]['name'] ? smithchart.series[i]['name'] : 'series' + i,\n          seriesIndex: i,\n          shape: smithchart.legendSettings.shape,\n          fill: smithchart.series[i].fill || smithchart.seriesColors[i % smithchart.seriesColors.length],\n          bounds: null\n        });\n\n        var legendsize = this._getLegendSize(smithchart, this.legendSeries[i]);\n\n        legendItemWidth = Math.max(legendsize['width'], legendItemWidth);\n        legendItemHeight = Math.max(legendsize['height'], legendItemHeight);\n        this.legendSeries[i]['bounds'] = {\n          width: legendItemWidth,\n          height: legendItemHeight\n        };\n        itemsCountRow = itemsCountRow + 1;\n        curRowWidth = curRowWidth + legendItemWidth + itemPadding;\n        curRowHeight = Math.max(legendItemHeight, curRowHeight);\n\n        if (position === 'top' || position === 'bottom' || position === 'custom') {\n          if (curRowWidth > svgObjectWidth) {\n            curRowWidth -= legendsize.width + itemPadding;\n            maxRowWidth = Math.max(maxRowWidth, curRowWidth);\n            curRowWidth = legendsize.width + itemPadding;\n            totalRowHeight = totalRowHeight + curRowHeight + itemPadding;\n          }\n        }\n\n        if (itemsCountRow === allowItems || i === length - 1) {\n          maxRowWidth = Math.max(maxRowWidth, curRowWidth);\n          totalRowHeight = totalRowHeight + curRowHeight + itemPadding;\n          legendHeight = totalRowHeight;\n          itemsCountRow = 0;\n          curRowHeight = 0;\n          curRowWidth = 0;\n        }\n      }\n\n      width = titleSize.width > maxRowWidth - itemPadding ? titleSize.width + padding * 2 + itemPadding : maxRowWidth + padding * 2 - smithchart.border.width * 2;\n      height = legendHeight + smithchart.elementSpacing;\n      legendBounds = {\n        x: 0,\n        y: 0,\n        width: width,\n        height: height\n      };\n    }\n\n    this.legendActualBounds = legendBounds;\n\n    if (legendSizeWidth != null) {\n      this.legendActualBounds.width = legendSizeWidth;\n    }\n\n    if (legendSizeHeight != null) {\n      this.legendActualBounds.height = legendSizeHeight;\n    }\n  };\n\n  SmithchartLegend.prototype._getLegendSize = function (smithchart, series) {\n    var legend = smithchart.legendSettings;\n    var symbolWidth = legend.itemStyle.width;\n    var symbolHeight = legend.itemStyle.height;\n    var textSize = measureText(series.text, legend.textStyle);\n    var width = symbolWidth + textSize.width + legend.shapePadding;\n    var height = Math.max(symbolHeight, textSize.height);\n    return {\n      width: width,\n      height: height\n    };\n  }; // tslint:disable:max-func-body-length\n\n\n  SmithchartLegend.prototype._drawLegend = function (smithchart) {\n    var legend = smithchart.legendSettings;\n    var legendPosition = legend.position.toLowerCase();\n    var alignment = legend.alignment;\n    var legendBounds = this.legendActualBounds;\n    var maxWidth = 0;\n    var startX;\n    var startY;\n    var titleFont = smithchart.title.font ? smithchart.title.font : smithchart.title.textStyle;\n    var smithchartTitleHeight = measureText(smithchart.title.text, titleFont).height;\n    var smithchartSubtitleHeight = measureText(smithchart.title.subtitle.text, smithchart.title.subtitle.textStyle).height;\n    var elementSpacing = smithchart.elementSpacing;\n    var offset = smithchartTitleHeight + smithchartSubtitleHeight + elementSpacing + smithchart.margin.top;\n    var itemPadding = legend.itemPadding > 0 ? legend.itemPadding : 0;\n    var svgObjectWidth = smithchart.availableSize.width;\n    var svgObjectHeight = smithchart.availableSize.height;\n    var legendBorder = legend.border.width;\n    var legendWidth = 0;\n    var titleSize = measureText(legend['title']['text'], legend.title.textStyle);\n    var legendTitleHeight = titleSize.height;\n    var borderSize = smithchart.border.width;\n    var svgWidth = svgObjectWidth - borderSize * 2;\n    var svgHeight = svgObjectHeight - borderSize * 2;\n    legendBounds.height += legendTitleHeight;\n\n    if (legendPosition !== 'custom') {\n      switch (legendPosition) {\n        case 'bottom':\n          legendBounds.y = svgHeight - (legendBounds.height + legendBorder + elementSpacing);\n          break;\n\n        case 'top':\n          legendBounds.y = borderSize + offset;\n          break;\n\n        case 'right':\n          legendBounds.x = svgWidth - legendBounds.width - elementSpacing * 2;\n          break;\n\n        case 'left':\n          legendBounds.x = borderSize + elementSpacing * 2;\n          break;\n      }\n\n      if (legendPosition === 'left' || legendPosition === 'right') {\n        switch (alignment) {\n          case 'Center':\n            legendBounds.y = svgHeight / 2 - (legendBounds.height + legendBorder * 2) / 2 + elementSpacing / 2;\n            break;\n\n          case 'Near':\n            legendBounds.y = borderSize + elementSpacing * 2 + offset;\n            break;\n\n          case 'Far':\n            legendBounds.y = svgHeight - (legendBounds.height + legendBorder) - elementSpacing * 2;\n            break;\n        }\n      } else {\n        switch (alignment) {\n          case 'Center':\n            legendBounds.x = svgWidth / 2 - (legendBounds.width + legendBorder * 2) / 2 + elementSpacing / 2;\n            break;\n\n          case 'Near':\n            legendBounds.x = borderSize + elementSpacing * 2;\n            break;\n\n          case 'Far':\n            legendBounds.x = svgWidth - (legendBounds.width + legendBorder) - elementSpacing * 2;\n            break;\n        }\n      }\n    } else {\n      legendBounds.y = legend.location.y < svgHeight ? legend.location.y : 0;\n      legendBounds.x = legend.location.x < svgWidth ? legend.location.x : 0;\n    }\n\n    if (legendPosition === 'bottom' || legendPosition === 'top') {\n      for (var i = 0; i < this.legendSeries.length; i++) {\n        legendWidth += this.legendSeries[i].bounds.width + itemPadding;\n\n        if (legendWidth > svgWidth) {\n          legendBounds.x = svgWidth / 2 - (legendBounds.width + legendBorder * 2) / 2 + elementSpacing / 2;\n          break;\n        }\n      }\n    }\n\n    var gLegendEle = smithchart.renderer.createGroup({\n      'id': smithchart.element.id + '_legend_group'\n    });\n    smithchart.svgObject.appendChild(gLegendEle);\n    this.legendItemGroup = smithchart.renderer.createGroup({\n      'id': smithchart.element.id + 'legendItem_Group'\n    });\n    var currentX = startX = elementSpacing;\n    var currentY = startY = elementSpacing;\n\n    if (legend.title.text !== '' && legend.title.visible) {\n      gLegendEle.appendChild(this.drawLegendTitle(smithchart, legend, legendBounds, gLegendEle));\n      currentY = startY = elementSpacing + legendTitleHeight;\n    }\n\n    for (var k = 0; k < this.legendSeries.length; k++) {\n      if ((legend.rowCount < legend.columnCount || legend.rowCount === legend.columnCount) && (legendPosition === 'top' || legendPosition === 'bottom' || legendPosition === 'custom')) {\n        if (currentX + this.legendSeries[k]['bounds'].width > legendBounds.width + startX) {\n          currentX = elementSpacing;\n          currentY += this.legendSeries[k]['bounds'].height + itemPadding;\n        }\n\n        this.legendGroup = this.drawLegendItem(smithchart, legend, this.legendSeries[k], k, currentX, currentY, legendBounds);\n        gLegendEle.appendChild(this.legendGroup);\n        currentX += this.legendSeries[k]['bounds'].width + itemPadding;\n      } else {\n        if (currentY + this.legendSeries[k]['bounds'].height + itemPadding + legendTitleHeight + borderSize > legendBounds.height + startY) {\n          currentY = startY;\n          currentX += maxWidth + itemPadding;\n        }\n\n        this.legendGroup = this.drawLegendItem(smithchart, legend, this.legendSeries[k], k, currentX, currentY, legendBounds);\n        gLegendEle.appendChild(this.legendGroup);\n        currentY += this.legendSeries[k]['bounds'].height + itemPadding;\n        maxWidth = Math.max(maxWidth, this.legendSeries[k]['bounds'].width);\n      }\n    }\n\n    gLegendEle.setAttribute('transform', 'translate(' + legendBounds.x.toString() + ',' + legendBounds.y.toString() + ')');\n    this.drawLegendBorder(gLegendEle, smithchart, legend, legendBounds);\n  };\n\n  SmithchartLegend.prototype.drawLegendBorder = function (gLegendEle, smithchart, legend, legendBounds) {\n    var borderRect = new RectOption(smithchart.element.id + '_svg' + '_legendRect', 'none', legend.border, 1, new SmithchartRect(0, 0, legendBounds.width, legendBounds.height));\n    gLegendEle.appendChild(smithchart.renderer.drawRectangle(borderRect));\n  };\n\n  SmithchartLegend.prototype.drawLegendTitle = function (smithchart, legend, legendBounds, gLegendEle) {\n    var elementSpacing = smithchart.elementSpacing;\n    var titleSize = measureText(legend.title.text, legend.title.textStyle);\n    var titleWidth = titleSize.width;\n    var titleHeight = titleSize.height;\n    var textAlignment = legend.title.textAlignment;\n    var startX = 0;\n    var legendBoundsWidth = legendBounds.width;\n    var startY = elementSpacing + titleHeight / 2;\n\n    switch (textAlignment) {\n      case 'Far':\n        startX = legendBoundsWidth - titleWidth - startX;\n        break;\n\n      case 'Center':\n        startX = legendBoundsWidth / 2 - titleWidth / 2;\n        break;\n    }\n\n    if (startX < 0) {\n      startX = 0;\n      legendBoundsWidth = titleWidth;\n    }\n\n    if (legendBoundsWidth < titleWidth + startX) {\n      legendBoundsWidth = titleWidth + startX;\n    }\n\n    var options = new TextOption(smithchart.element.id + '_LegendTitleText', startX, startY, 'start', legend.title.text);\n    var element = renderTextElement(options, legend.title.textStyle, smithchart.themeStyle.legendLabel, gLegendEle);\n    element.setAttribute('aria-label', legend.title.description || legend.title.text);\n    return element;\n  };\n\n  SmithchartLegend.prototype.drawLegendItem = function (smithchart, legend, legendSeries, k, x, y, legendBounds) {\n    var _this = this;\n\n    var location;\n    var radius;\n    var symbol = legend.itemStyle;\n    var itemPadding = legend.itemPadding;\n    var textHeight;\n    radius = Math.sqrt(symbol['width'] * symbol['width'] + symbol['height'] * symbol['height']) / 2;\n    textHeight = measureText(legendSeries['text'], legend.textStyle).height;\n    location = {\n      x: x + symbol['width'] / 2,\n      y: y + (textHeight > symbol['height'] ? textHeight : symbol['height']) / 2\n    };\n    var legendGroup = smithchart.renderer.createGroup({\n      id: smithchart.element.id + '_svg' + '_Legend' + k.toString()\n    });\n    legendGroup['style']['cursor'] = legend.toggleVisibility ? 'pointer' : 'default';\n    var legendEventArgs = {\n      text: legendSeries['text'],\n      fill: legendSeries['fill'],\n      shape: legendSeries['shape'],\n      name: legendRender,\n      cancel: false\n    };\n\n    var legendRenderSuccess = function (args) {\n      if (!args.cancel) {\n        var shape = _this.drawLegendShape(smithchart, legendSeries, location.x, location.y, k, legend, args);\n\n        legendGroup.appendChild(shape);\n        var options = new TextOption(smithchart.element.id + '_LegendItemText' + k.toString(), location.x + symbol['width'] / 2 + legend.shapePadding, location.y + textHeight / 4, 'start', args.text);\n        legend.textStyle.fontFamily = smithchart.themeStyle.fontFamily || legend.textStyle.fontFamily;\n        legend.textStyle.size = smithchart.themeStyle.fontSize || legend.textStyle.size;\n        var element = renderTextElement(options, legend.textStyle, smithchart.themeStyle.legendLabel, legendGroup);\n        element.setAttribute('aria-label', legend.description || 'Click to show or hide the ' + options.text + ' series');\n        legendGroup.appendChild(element);\n\n        _this.legendItemGroup.appendChild(legendGroup);\n      }\n    };\n\n    legendRenderSuccess.bind(this);\n    smithchart.trigger(legendRender, legendEventArgs, legendRenderSuccess);\n    return this.legendItemGroup;\n  };\n\n  SmithchartLegend.prototype.drawLegendShape = function (smithchart, legendSeries, locX, locY, index, legend, legendEventArgs) {\n    var element;\n    var circleOptions;\n    var pathOptions;\n    var path;\n    var symbol = legend.itemStyle;\n    var width = symbol['width'];\n    var height = symbol['height'];\n    var x = locX + -width / 2;\n    var y = locY + -height / 2;\n    var border = {\n      color: symbol.border.color,\n      width: symbol.border.width\n    };\n    var opacity = 1;\n    var fill = smithchart.series[index].visibility === 'visible' ? legendEventArgs.fill : 'grey';\n    var shape = legendEventArgs.shape.toLowerCase();\n    var radius = Math.sqrt(height * height + width * width) / 2;\n\n    switch (shape) {\n      case 'circle':\n        circleOptions = new CircleOption(smithchart.element.id + '_svg' + '_LegendItemShape' + index.toString(), fill, border, opacity, locX, locY, radius, null);\n        element = smithchart.renderer.drawCircle(circleOptions);\n        break;\n\n      case 'rectangle':\n        path = 'M' + ' ' + x + ' ' + (locY + -height / 2) + ' ' + 'L' + ' ' + (width / 2 + locX) + ' ' + (locY + -height / 2) + ' ' + 'L' + ' ' + (locX + width / 2) + ' ' + (locY + height / 2) + ' ' + 'L' + ' ' + x + ' ' + (locY + height / 2) + ' ' + 'L' + ' ' + x + ' ' + (locY + -height / 2) + ' z';\n        pathOptions = new PathOption(smithchart.element.id + '_svg' + '_LegendItemShape' + index.toString(), fill, border.width, border.color, 1, '', path);\n        element = smithchart.renderer.drawPath(pathOptions);\n        break;\n\n      case 'diamond':\n        path = 'M' + ' ' + x + ' ' + locY + ' ' + 'L' + ' ' + locX + ' ' + (locY + -height / 2) + ' ' + 'L' + ' ' + (width / 2 + locX) + ' ' + locY + ' ' + 'L' + ' ' + locX + ' ' + (locY + height / 2) + ' ' + 'L' + ' ' + x + ' ' + locY + ' z';\n        pathOptions = new PathOption(smithchart.element.id + '_svg' + '_LegendItemShape' + index.toString(), fill, border.width, border.color, 1, '', path);\n        element = smithchart.renderer.drawPath(pathOptions);\n        break;\n\n      case 'pentagon':\n        var eq = 72;\n\n        for (var j = 0; j <= 5; j++) {\n          var xValue = radius * Math.cos(Math.PI / 180 * (j * eq));\n          var yValue = radius * Math.sin(Math.PI / 180 * (j * eq));\n\n          if (j === 0) {\n            path = 'M' + ' ' + (xValue + locX) + ' ' + (locY + yValue) + ' ';\n          } else {\n            path = path.concat('L' + ' ' + (locX + xValue) + ' ' + (locY + yValue) + ' ');\n          }\n        }\n\n        path = path.concat('Z');\n        pathOptions = new PathOption(smithchart.element.id + '_svg' + '_LegendItemShape' + index.toString(), fill, border.width, border.color, 1, '', path);\n        element = smithchart.renderer.drawPath(pathOptions);\n        break;\n\n      case 'triangle':\n        path = 'M' + ' ' + x + ' ' + (height / 2 + locY) + ' ' + 'L' + ' ' + locX + ' ' + (locY + -height / 2) + ' ' + 'L' + ' ' + (locX + width / 2) + ' ' + (locY + height / 2) + ' ' + 'L' + ' ' + x + ' ' + (locY + height / 2) + ' Z';\n        pathOptions = new PathOption(smithchart.element.id + '_svg' + '_LegendItemShape' + index.toString(), fill, border.width, border.color, 1, '', path);\n        element = smithchart.renderer.drawPath(pathOptions);\n        break;\n    }\n\n    return element;\n  };\n  /**\n   * Get module name.\n   */\n\n\n  SmithchartLegend.prototype.getModuleName = function () {\n    return 'SmithchartLegend';\n  };\n  /**\n   * To destroy the legend.\n   * @return {void}\n   * @private\n   */\n\n\n  SmithchartLegend.prototype.destroy = function (smithchart) {\n    /**\n     * Destroy method performed here\n     */\n  };\n\n  return SmithchartLegend;\n}();\n\nexport { SmithchartLegend };","map":{"version":3,"sources":["C:/Users/Power GSM/Desktop/React-Fito-v1.0-9-April-2021V/React-Fito-v1.0-9-April-2021V/react-fito/node_modules/@syncfusion/ej2-charts/src/smithchart/legend/legendrender.js"],"names":["measureText","TextOption","renderTextElement","CircleOption","PathOption","RectOption","SmithchartRect","LegendSeries","legendRender","SmithchartLegend","legendSeries","prototype","renderLegend","smithchart","calculateLegendBounds","_drawLegend","legendActualBounds","padding","legend","legendSettings","legendSizeHeight","height","legendSizeWidth","width","itemPadding","position","toLowerCase","font","title","textStyle","legendItemWidth","legendItemHeight","legendHeight","svgObjectWidth","availableSize","elementSpacing","border","svgObjectHeight","rowCount","columnCount","titleSize","maxRowWidth","totalRowHeight","curRowWidth","curRowHeight","allowItems","itemsCountRow","length","series","legendBounds","visible","Math","ceil","i","push","text","seriesIndex","shape","fill","seriesColors","bounds","legendsize","_getLegendSize","max","x","y","symbolWidth","itemStyle","symbolHeight","textSize","shapePadding","legendPosition","alignment","maxWidth","startX","startY","titleFont","smithchartTitleHeight","smithchartSubtitleHeight","subtitle","offset","margin","top","legendBorder","legendWidth","legendTitleHeight","borderSize","svgWidth","svgHeight","location","gLegendEle","renderer","createGroup","element","id","svgObject","appendChild","legendItemGroup","currentX","currentY","drawLegendTitle","k","legendGroup","drawLegendItem","setAttribute","toString","drawLegendBorder","borderRect","drawRectangle","titleWidth","titleHeight","textAlignment","legendBoundsWidth","options","themeStyle","legendLabel","description","_this","radius","symbol","textHeight","sqrt","toggleVisibility","legendEventArgs","name","cancel","legendRenderSuccess","args","drawLegendShape","fontFamily","size","fontSize","bind","trigger","locX","locY","index","circleOptions","pathOptions","path","color","opacity","visibility","drawCircle","drawPath","eq","j","xValue","cos","PI","yValue","sin","concat","getModuleName","destroy"],"mappings":"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","sourcesContent":["import { measureText, TextOption, renderTextElement, CircleOption, PathOption, RectOption } from '../../smithchart/utils/helper';\nimport { SmithchartRect, LegendSeries } from '../../smithchart/utils/utils';\nimport { legendRender } from '../model/constant';\n/* tslint:disable:no-string-literal */\nvar SmithchartLegend = /** @class */ (function () {\n    function SmithchartLegend() {\n        this.legendSeries = [];\n    }\n    SmithchartLegend.prototype.renderLegend = function (smithchart) {\n        this.calculateLegendBounds(smithchart);\n        this._drawLegend(smithchart);\n        return this.legendActualBounds;\n    };\n    SmithchartLegend.prototype.calculateLegendBounds = function (smithchart) {\n        var legendSeries = new LegendSeries();\n        this.legendSeries = [];\n        var padding = 10;\n        var legend = smithchart.legendSettings;\n        var legendSizeHeight = legend.height;\n        var legendSizeWidth = legend.width;\n        var itemPadding = legend.itemPadding > 0 ? legend.itemPadding : 0;\n        var position = legend.position.toLowerCase();\n        var font = legend.title.textStyle;\n        var width = 0;\n        var height = 0;\n        var legendItemWidth = 0;\n        var legendItemHeight = 0;\n        var legendHeight = 0;\n        var svgObjectWidth = smithchart.availableSize.width - ((smithchart.elementSpacing * 4) - (legend.border.width * 2)\n            + (smithchart.border.width * 2));\n        var svgObjectHeight = smithchart.availableSize.height - ((smithchart.elementSpacing * 4) - (legend.border.width * 2)\n            + (smithchart.border.width * 2));\n        var rowCount = legend.rowCount;\n        var columnCount = legend.columnCount;\n        var titleSize = measureText(smithchart.legendSettings['title']['text'], font);\n        var maxRowWidth = 0;\n        var totalRowHeight = 0;\n        var curRowWidth = 0;\n        var curRowHeight = 0;\n        var allowItems;\n        var itemsCountRow = 0;\n        var length = smithchart.series.length;\n        var legendBounds;\n        if (smithchart.legendSettings.visible && length !== 0) {\n            if (position === 'bottom' || position === 'top' || position === 'custom') {\n                if ((rowCount && columnCount) && (rowCount <= columnCount)) {\n                    rowCount = length / columnCount;\n                }\n                else if (rowCount == null && columnCount != null) {\n                    rowCount = length / columnCount;\n                }\n                else if (rowCount == null && columnCount == null) {\n                    rowCount = 1;\n                }\n                if (rowCount) {\n                    allowItems = Math.ceil(length / rowCount);\n                }\n            }\n            else {\n                if ((rowCount && columnCount) && (rowCount <= columnCount)) {\n                    columnCount = length / rowCount;\n                }\n                else if (rowCount != null && columnCount == null) {\n                    columnCount = length / rowCount;\n                }\n                else if (rowCount == null && columnCount == null) {\n                    columnCount = 1;\n                }\n                if (columnCount) {\n                    allowItems = columnCount;\n                }\n            }\n            for (var i = 0; i < length; i++) {\n                this.legendSeries.push({\n                    text: smithchart.series[i]['name'] ? smithchart.series[i]['name'] : 'series' + i,\n                    seriesIndex: i,\n                    shape: smithchart.legendSettings.shape,\n                    fill: smithchart.series[i].fill || smithchart.seriesColors[i % smithchart.seriesColors.length],\n                    bounds: null\n                });\n                var legendsize = this._getLegendSize(smithchart, this.legendSeries[i]);\n                legendItemWidth = Math.max(legendsize['width'], legendItemWidth);\n                legendItemHeight = Math.max(legendsize['height'], legendItemHeight);\n                this.legendSeries[i]['bounds'] = { width: legendItemWidth, height: legendItemHeight };\n                itemsCountRow = itemsCountRow + 1;\n                curRowWidth = curRowWidth + legendItemWidth + itemPadding;\n                curRowHeight = Math.max(legendItemHeight, curRowHeight);\n                if (position === 'top' || position === 'bottom' || position === 'custom') {\n                    if (curRowWidth > svgObjectWidth) {\n                        curRowWidth -= legendsize.width + itemPadding;\n                        maxRowWidth = Math.max(maxRowWidth, curRowWidth);\n                        curRowWidth = legendsize.width + itemPadding;\n                        totalRowHeight = totalRowHeight + curRowHeight + itemPadding;\n                    }\n                }\n                if (itemsCountRow === allowItems || i === length - 1) {\n                    maxRowWidth = Math.max(maxRowWidth, curRowWidth);\n                    totalRowHeight = totalRowHeight + curRowHeight + itemPadding;\n                    legendHeight = totalRowHeight;\n                    itemsCountRow = 0;\n                    curRowHeight = 0;\n                    curRowWidth = 0;\n                }\n            }\n            width = (titleSize.width) > maxRowWidth - itemPadding ? (titleSize.width + padding * 2 + itemPadding) :\n                maxRowWidth + padding * 2 - (smithchart.border.width * 2);\n            height = legendHeight + smithchart.elementSpacing;\n            legendBounds = { x: 0, y: 0, width: width, height: height };\n        }\n        this.legendActualBounds = legendBounds;\n        if (legendSizeWidth != null) {\n            this.legendActualBounds.width = legendSizeWidth;\n        }\n        if (legendSizeHeight != null) {\n            this.legendActualBounds.height = legendSizeHeight;\n        }\n    };\n    SmithchartLegend.prototype._getLegendSize = function (smithchart, series) {\n        var legend = smithchart.legendSettings;\n        var symbolWidth = legend.itemStyle.width;\n        var symbolHeight = legend.itemStyle.height;\n        var textSize = measureText(series.text, legend.textStyle);\n        var width = symbolWidth + textSize.width + legend.shapePadding;\n        var height = Math.max(symbolHeight, textSize.height);\n        return { width: width, height: height };\n    };\n    // tslint:disable:max-func-body-length\n    SmithchartLegend.prototype._drawLegend = function (smithchart) {\n        var legend = smithchart.legendSettings;\n        var legendPosition = legend.position.toLowerCase();\n        var alignment = legend.alignment;\n        var legendBounds = this.legendActualBounds;\n        var maxWidth = 0;\n        var startX;\n        var startY;\n        var titleFont = smithchart.title.font ? smithchart.title.font : smithchart.title.textStyle;\n        var smithchartTitleHeight = measureText(smithchart.title.text, titleFont).height;\n        var smithchartSubtitleHeight = measureText(smithchart.title.subtitle.text, smithchart.title.subtitle.textStyle).height;\n        var elementSpacing = smithchart.elementSpacing;\n        var offset = smithchartTitleHeight + smithchartSubtitleHeight + elementSpacing + smithchart.margin.top;\n        var itemPadding = legend.itemPadding > 0 ? legend.itemPadding : 0;\n        var svgObjectWidth = smithchart.availableSize.width;\n        var svgObjectHeight = smithchart.availableSize.height;\n        var legendBorder = legend.border.width;\n        var legendWidth = 0;\n        var titleSize = measureText(legend['title']['text'], legend.title.textStyle);\n        var legendTitleHeight = titleSize.height;\n        var borderSize = smithchart.border.width;\n        var svgWidth = svgObjectWidth - ((borderSize * 2));\n        var svgHeight = svgObjectHeight - ((borderSize * 2));\n        legendBounds.height += legendTitleHeight;\n        if (legendPosition !== 'custom') {\n            switch (legendPosition) {\n                case 'bottom':\n                    legendBounds.y = svgHeight - (legendBounds.height + (legendBorder) + elementSpacing);\n                    break;\n                case 'top':\n                    legendBounds.y = borderSize + offset;\n                    break;\n                case 'right':\n                    legendBounds.x = svgWidth - legendBounds.width - (elementSpacing * 2);\n                    break;\n                case 'left':\n                    legendBounds.x = borderSize + (elementSpacing * 2);\n                    break;\n            }\n            if (legendPosition === 'left' || legendPosition === 'right') {\n                switch (alignment) {\n                    case 'Center':\n                        legendBounds.y = (svgHeight / 2) - ((legendBounds.height + legendBorder * 2) / 2) + (elementSpacing / 2);\n                        break;\n                    case 'Near':\n                        legendBounds.y = borderSize + (elementSpacing * 2) + offset;\n                        break;\n                    case 'Far':\n                        legendBounds.y = svgHeight - (legendBounds.height + (legendBorder)) - (elementSpacing * 2);\n                        break;\n                }\n            }\n            else {\n                switch (alignment) {\n                    case 'Center':\n                        legendBounds.x = (svgWidth / 2) - ((legendBounds.width + legendBorder * 2) / 2) + (elementSpacing / 2);\n                        break;\n                    case 'Near':\n                        legendBounds.x = borderSize + (elementSpacing * 2);\n                        break;\n                    case 'Far':\n                        legendBounds.x = svgWidth - (legendBounds.width + (legendBorder)) - (elementSpacing * 2);\n                        break;\n                }\n            }\n        }\n        else {\n            legendBounds.y = (legend.location.y < svgHeight) ? legend.location.y : 0;\n            legendBounds.x = (legend.location.x < svgWidth) ? legend.location.x : 0;\n        }\n        if (legendPosition === 'bottom' || legendPosition === 'top') {\n            for (var i = 0; i < this.legendSeries.length; i++) {\n                legendWidth += this.legendSeries[i].bounds.width + itemPadding;\n                if (legendWidth > svgWidth) {\n                    legendBounds.x = (svgWidth / 2) - ((legendBounds.width + legendBorder * 2) / 2) + (elementSpacing / 2);\n                    break;\n                }\n            }\n        }\n        var gLegendEle = smithchart.renderer.createGroup({ 'id': smithchart.element.id + '_legend_group' });\n        smithchart.svgObject.appendChild(gLegendEle);\n        this.legendItemGroup = smithchart.renderer.createGroup({ 'id': smithchart.element.id + 'legendItem_Group' });\n        var currentX = startX = elementSpacing;\n        var currentY = startY = elementSpacing;\n        if (legend.title.text !== '' && legend.title.visible) {\n            gLegendEle.appendChild(this.drawLegendTitle(smithchart, legend, legendBounds, gLegendEle));\n            currentY = startY = elementSpacing + legendTitleHeight;\n        }\n        for (var k = 0; k < this.legendSeries.length; k++) {\n            if ((legend.rowCount < legend.columnCount || legend.rowCount === legend.columnCount) &&\n                (legendPosition === 'top' || legendPosition === 'bottom' || legendPosition === 'custom')) {\n                if ((currentX + this.legendSeries[k]['bounds'].width) > legendBounds.width + startX) {\n                    currentX = elementSpacing;\n                    currentY += this.legendSeries[k]['bounds'].height + itemPadding;\n                }\n                this.legendGroup = this.drawLegendItem(smithchart, legend, this.legendSeries[k], k, currentX, (currentY), legendBounds);\n                gLegendEle.appendChild(this.legendGroup);\n                currentX += this.legendSeries[k]['bounds'].width + itemPadding;\n            }\n            else {\n                if (((currentY + this.legendSeries[k]['bounds'].height + itemPadding) +\n                    legendTitleHeight + borderSize > legendBounds.height + startY)) {\n                    currentY = startY;\n                    currentX += maxWidth + (itemPadding);\n                }\n                this.legendGroup = this.drawLegendItem(smithchart, legend, this.legendSeries[k], k, (currentX), (currentY), legendBounds);\n                gLegendEle.appendChild(this.legendGroup);\n                currentY += this.legendSeries[k]['bounds'].height + itemPadding;\n                maxWidth = Math.max(maxWidth, this.legendSeries[k]['bounds'].width);\n            }\n        }\n        gLegendEle.setAttribute('transform', 'translate(' + legendBounds.x.toString() + ',' + legendBounds.y.toString() + ')');\n        this.drawLegendBorder(gLegendEle, smithchart, legend, legendBounds);\n    };\n    SmithchartLegend.prototype.drawLegendBorder = function (gLegendEle, smithchart, legend, legendBounds) {\n        var borderRect = new RectOption(smithchart.element.id + '_svg' + '_legendRect', 'none', legend.border, 1, new SmithchartRect(0, 0, legendBounds.width, legendBounds.height));\n        gLegendEle.appendChild(smithchart.renderer.drawRectangle(borderRect));\n    };\n    SmithchartLegend.prototype.drawLegendTitle = function (smithchart, legend, legendBounds, gLegendEle) {\n        var elementSpacing = smithchart.elementSpacing;\n        var titleSize = measureText(legend.title.text, legend.title.textStyle);\n        var titleWidth = titleSize.width;\n        var titleHeight = titleSize.height;\n        var textAlignment = legend.title.textAlignment;\n        var startX = 0;\n        var legendBoundsWidth = legendBounds.width;\n        var startY = elementSpacing + (titleHeight / 2);\n        switch (textAlignment) {\n            case 'Far':\n                startX = legendBoundsWidth - titleWidth - startX;\n                break;\n            case 'Center':\n                startX = legendBoundsWidth / 2 - (titleWidth) / 2;\n                break;\n        }\n        if (startX < 0) {\n            startX = 0;\n            legendBoundsWidth = titleWidth;\n        }\n        if (legendBoundsWidth < titleWidth + startX) {\n            legendBoundsWidth = titleWidth + startX;\n        }\n        var options = new TextOption(smithchart.element.id + '_LegendTitleText', startX, startY, 'start', legend.title.text);\n        var element = renderTextElement(options, legend.title.textStyle, smithchart.themeStyle.legendLabel, gLegendEle);\n        element.setAttribute('aria-label', legend.title.description || legend.title.text);\n        return element;\n    };\n    SmithchartLegend.prototype.drawLegendItem = function (smithchart, legend, legendSeries, k, x, y, legendBounds) {\n        var _this = this;\n        var location;\n        var radius;\n        var symbol = legend.itemStyle;\n        var itemPadding = legend.itemPadding;\n        var textHeight;\n        radius = Math.sqrt(symbol['width'] * symbol['width'] + symbol['height'] * symbol['height']) / 2;\n        textHeight = measureText(legendSeries['text'], legend.textStyle).height;\n        location = {\n            x: x + symbol['width'] / 2,\n            y: (y + (textHeight > symbol['height'] ? textHeight : symbol['height']) / 2)\n        };\n        var legendGroup = smithchart.renderer.createGroup({ id: smithchart.element.id + '_svg' + '_Legend' + k.toString() });\n        legendGroup['style']['cursor'] = legend.toggleVisibility ? 'pointer' : 'default';\n        var legendEventArgs = {\n            text: legendSeries['text'],\n            fill: legendSeries['fill'],\n            shape: legendSeries['shape'],\n            name: legendRender,\n            cancel: false\n        };\n        var legendRenderSuccess = function (args) {\n            if (!args.cancel) {\n                var shape = _this.drawLegendShape(smithchart, legendSeries, location.x, location.y, k, legend, args);\n                legendGroup.appendChild(shape);\n                var options = new TextOption(smithchart.element.id + '_LegendItemText' + k.toString(), location.x + symbol['width'] / 2 + legend.shapePadding, location.y + textHeight / 4, 'start', args.text);\n                legend.textStyle.fontFamily = smithchart.themeStyle.fontFamily || legend.textStyle.fontFamily;\n                legend.textStyle.size = smithchart.themeStyle.fontSize || legend.textStyle.size;\n                var element = renderTextElement(options, legend.textStyle, smithchart.themeStyle.legendLabel, legendGroup);\n                element.setAttribute('aria-label', legend.description || 'Click to show or hide the ' + options.text + ' series');\n                legendGroup.appendChild(element);\n                _this.legendItemGroup.appendChild(legendGroup);\n            }\n        };\n        legendRenderSuccess.bind(this);\n        smithchart.trigger(legendRender, legendEventArgs, legendRenderSuccess);\n        return this.legendItemGroup;\n    };\n    SmithchartLegend.prototype.drawLegendShape = function (smithchart, legendSeries, locX, locY, index, legend, legendEventArgs) {\n        var element;\n        var circleOptions;\n        var pathOptions;\n        var path;\n        var symbol = legend.itemStyle;\n        var width = symbol['width'];\n        var height = symbol['height'];\n        var x = locX + (-width / 2);\n        var y = locY + (-height / 2);\n        var border = { color: symbol.border.color, width: symbol.border.width };\n        var opacity = 1;\n        var fill = (smithchart.series[index].visibility === 'visible') ? legendEventArgs.fill : 'grey';\n        var shape = legendEventArgs.shape.toLowerCase();\n        var radius = Math.sqrt(height * height + width * width) / 2;\n        switch (shape) {\n            case 'circle':\n                circleOptions = new CircleOption(smithchart.element.id + '_svg' + '_LegendItemShape' + index.toString(), fill, border, opacity, locX, locY, radius, null);\n                element = smithchart.renderer.drawCircle(circleOptions);\n                break;\n            case 'rectangle':\n                path = 'M' + ' ' + x + ' ' + (locY + (-height / 2)) + ' ' +\n                    'L' + ' ' + ((width / 2) + locX) + ' ' + (locY + (-height / 2)) + ' ' +\n                    'L' + ' ' + (locX + (width / 2)) + ' ' + (locY + (height / 2)) + ' ' +\n                    'L' + ' ' + x + ' ' + (locY + (height / 2)) + ' ' +\n                    'L' + ' ' + x + ' ' + (locY + (-height / 2)) + ' z';\n                pathOptions = new PathOption(smithchart.element.id + '_svg' + '_LegendItemShape' + index.toString(), fill, border.width, border.color, 1, '', path);\n                element = smithchart.renderer.drawPath(pathOptions);\n                break;\n            case 'diamond':\n                path = 'M' + ' ' + x + ' ' + locY + ' ' +\n                    'L' + ' ' + locX + ' ' + (locY + (-height / 2)) + ' ' +\n                    'L' + ' ' + ((width / 2) + locX) + ' ' + locY + ' ' +\n                    'L' + ' ' + locX + ' ' + (locY + (height / 2)) + ' ' +\n                    'L' + ' ' + x + ' ' + locY + ' z';\n                pathOptions = new PathOption(smithchart.element.id + '_svg' + '_LegendItemShape' + index.toString(), fill, border.width, border.color, 1, '', path);\n                element = smithchart.renderer.drawPath(pathOptions);\n                break;\n            case 'pentagon':\n                var eq = 72;\n                for (var j = 0; j <= 5; j++) {\n                    var xValue = radius * Math.cos((Math.PI / 180) * (j * eq));\n                    var yValue = radius * Math.sin((Math.PI / 180) * (j * eq));\n                    if (j === 0) {\n                        path = 'M' + ' ' + (xValue + locX) + ' ' + (locY + yValue) + ' ';\n                    }\n                    else {\n                        path = path.concat('L' + ' ' + (locX + xValue) + ' ' + (locY + yValue) + ' ');\n                    }\n                }\n                path = path.concat('Z');\n                pathOptions = new PathOption(smithchart.element.id + '_svg' + '_LegendItemShape' + index.toString(), fill, border.width, border.color, 1, '', path);\n                element = smithchart.renderer.drawPath(pathOptions);\n                break;\n            case 'triangle':\n                path = 'M' + ' ' + x + ' ' + ((height / 2) + locY) + ' ' +\n                    'L' + ' ' + locX + ' ' + (locY + (-height / 2)) + ' ' +\n                    'L' + ' ' + (locX + (width / 2)) + ' ' + (locY + (height / 2)) + ' ' +\n                    'L' + ' ' + x + ' ' + (locY + (height / 2)) + ' Z';\n                pathOptions = new PathOption(smithchart.element.id + '_svg' + '_LegendItemShape' + index.toString(), fill, border.width, border.color, 1, '', path);\n                element = smithchart.renderer.drawPath(pathOptions);\n                break;\n        }\n        return element;\n    };\n    /**\n     * Get module name.\n     */\n    SmithchartLegend.prototype.getModuleName = function () {\n        return 'SmithchartLegend';\n    };\n    /**\n     * To destroy the legend.\n     * @return {void}\n     * @private\n     */\n    SmithchartLegend.prototype.destroy = function (smithchart) {\n        /**\n         * Destroy method performed here\n         */\n    };\n    return SmithchartLegend;\n}());\nexport { SmithchartLegend };\n"]},"metadata":{},"sourceType":"module"}